# Familiars

The familiar system lets you capture defeated enemies and summon them as companions.

## Overview

- Unlock familiars by defeating enemies
- Summon your favorites to fight alongside you
- Level up familiars with experience
- Allocate talents across three paths
- Battle other players' familiars

---

## Unlocking Familiars

When you defeat an enemy, there's a chance to unlock them:
- **Regular units:** Default 5% chance
- **VBloods:** Default 1% chance (if enabled)

<Callout type="info">
  VBlood familiars require `AllowVBloods = true` in config!
</Callout>

### Shiny Familiars

First unlock has a 20% chance for a random shiny effect. Second unlock of the same unit guarantees shiny. Shinies have a chance to proc spell school debuffs.

---

## Managing Familiars

### Boxes

Familiars are organized into boxes:
- Create custom boxes to organize your collection
- Move familiars between boxes
- Default "overflow" box for extras

### Binding

Bind a familiar to summon it:
```
.fam b [#]       ‚Üí Bind familiar by slot number
.fam sb [Name]   ‚Üí Smart bind by name search
.fam ub          ‚Üí Unbind current familiar
.fam t           ‚Üí Toggle summon/dismiss
```

---

## Familiar Leveling

Familiars gain XP when you kill enemies:
- Stats scale with familiar level
- Max level matches player max level by default
- Use `.fam gl` to check familiar progress

---

## Talent Trees

Familiars can allocate talent points across three paths:

| Path | Focus | Keystone Bonuses |
|------|-------|------------------|
| ‚ö° **Speed** | Attack speed, Movement | High mobility |
| üí™ **Power** | Physical power, Spell power | Max damage |
| ‚ù§Ô∏è **Vitality** | Max health, Damage reduction | Survivability |

Allocate points in the client's Familiars tab under the Talents panel.

---

## Familiar Battles

When enabled, challenge other players to familiar battles:

```
.fam challenge [Player]  ‚Üí Challenge a player
```

The challenged player can accept (emote yes) or decline (emote no).

### Battle Groups

Organize familiars into battle groups for team battles:
```
.fam abg [Name]   ‚Üí Create battle group
.fam cbg [Name]   ‚Üí Set active group
.fam sbg [Slot]   ‚Üí Assign familiar to slot (1-3)
.fam bg           ‚Üí View active group
```

---

## Shiny Buffs

Spend Vampiric Dust to apply or change shiny buffs:

```
.fam shiny [SpellSchool]
```

Spell schools: Blood, Chaos, Frost, Storm, Illusion, Unholy

---

## Chat Commands

### Basic Commands
| Command | Shortcut | Description |
|---------|----------|-------------|
| `.familiar list` | `.fam l` | List familiars in current box |
| `.familiar bind [#]` | `.fam b` | Bind familiar by slot |
| `.familiar unbind` | `.fam ub` | Unbind current familiar |
| `.familiar toggle` | `.fam t` | Call/dismiss familiar |
| `.familiar getlevel` | `.fam gl` | View familiar stats |

### Box Management
| Command | Shortcut | Description |
|---------|----------|-------------|
| `.familiar listboxes` | `.fam boxes` | Show available boxes |
| `.familiar choosebox [Name]` | `.fam cb` | Set active box |
| `.familiar addbox [Name]` | `.fam ab` | Create new box |
| `.familiar renamebox [Old] [New]` | `.fam rb` | Rename a box |
| `.familiar deletebox [Name]` | `.fam db` | Delete empty box |
| `.familiar movebox [Name]` | `.fam mb` | Move active familiar to box |

### Search & Actions
| Command | Shortcut | Description |
|---------|----------|-------------|
| `.familiar search [Name]` | `.fam s` | Search for familiar |
| `.familiar smartbind [Name]` | `.fam sb` | Search and bind |
| `.familiar remove [#]` | `.fam r` | Permanently remove |
| `.familiar reset` | `.fam reset` | Reset familiar state |

---

## Configuration

### Core Settings

| Option | Default | Description |
|--------|---------|-------------|
| `FamiliarSystem` | `false` | Enable/disable familiars |
| `FamiliarCombat` | `true` | Enable familiar combat |
| `FamiliarPvP` | `true` | Allow familiars in PvP |
| `MaxFamiliarLevel` | `90` | Max familiar level |

### Unlock Settings

| Option | Default | Description |
|--------|---------|-------------|
| `UnitUnlockChance` | `0.05` | Regular unit unlock (5%) |
| `VBloodUnlockChance` | `0.01` | VBlood unlock (1%) |
| `AllowVBloods` | `false` | Allow VBlood familiars |
| `AllowMinions` | `false` | Allow minion familiars |
| `BannedUnits` | `""` | Banned unit PrefabGUIDs |
| `BannedTypes` | `""` | Banned unit categories |

### Shiny Settings

| Option | Default | Description |
|--------|---------|-------------|
| `ShinyChance` | `0.2` | First unlock shiny chance |
| `ShinyCostItemQuantity` | `100` | Vampiric dust cost |

---

## Server Implementation

Key files:
- `Systems/Familiars/FamiliarSystem.cs` ‚Äî Core familiar logic
- `Systems/Familiars/FamiliarUnlockSystem.cs` ‚Äî Unlock handling
- `Systems/Familiars/FamiliarTalentSystem.cs` ‚Äî Talent trees
- `Commands/FamiliarCommands.cs` ‚Äî Chat commands
